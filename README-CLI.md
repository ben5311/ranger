**Table of Contents**
<!--ts-->

* [RangerCLI](#rangercli)
* [Installation](#installation)
* [Example](#example)
* [YAML Configuration structure](#yaml-configuration-structure)
* [Example with multiple outputs](#example-with-multiple-outputs)
* [Run time](#run-time)
* [Dry-run option](#dry-run-option)
* [Usage and command line options](#usage-and-command-line-options)

<!--te-->

# RangerCLI

**RangerCLI** is a command line tool, that easily generates test data with the help of [Ranger](README.md)
and saves it as file.

The test data can be configured via simple YAML configuration file and can then be generated by running **RangerCLI**.

Currently, following output formats are supported:

* csv
* json
* jsonl (new line delimited json)
* elastic_json (for [elasticsearch](https://www.elastic.co/de/elasticsearch/)).

# Installation

Download the latest **ranger-1.x.jar** [here](https://github.com/benjo053/ranger/releases/).

# Example

Create this YAML file:

```yaml
# example.yaml
values:
    person:
        name: random(["Max", "Moritz", "James", "Anna"])
        age: random(18..60)
        
output: $person

output_options:
    count: 30          # count of objects to generate
    format: "csv"      # the output format (csv, json, jsonl or elastic_json)
    csv:
        delimiter: ";"  # the CSV delimiter (if format is csv. Defaults to ",".)
```

Then run

```shell
java -jar ranger-1.2.1.jar "example.yaml"
```

It will create a CSV file similar to this one in the `output` directory:

```csv
# output/person.csv
name;age
Anna;56
Moritz;44
James;25
James;37
Max;57
James;4
Moritz;20
James;21
Moritz;42
Anna;42
```

# YAML Configuration structure

The YAML file must contain the three sections `values`, `output` and `output_options`.

```yaml
# example.yaml
values:
    person:
        name: random(["Max", "Moritz", "James", "Anna"])
        age: random(18..60)
        
output: $person

output_options:
    count: 30           # count of objects to generate
    format: "csv"       # the output format ("csv", "json", "jsonl" or "elastic_json")
    csv:            
        delimiter: ";"  # the CSV delimiter (applies only to "csv" output format. Defaults to ",".)
    elastic_json:   
        index: "my_index"   # the elasticsearch output index (applies only to "elastic_json" output format)
```

The `values` section contains value definitions. It defines how the output will look like. \
The `output` attribute is a reference to the value that shall be generated by the generator. \
The `output_options` section configures the output format, and the output count. Everything that is possible
for `output_options` can be seen in the above example.

> üìù **Ranger's [documentation](README.md#value-definition) explains the meaning of the
`values` section.**

# Example with multiple outputs

Create this YAML file:

```yaml
# example_two_outputs.yaml
values:
    person:
        id: random(1..100)
        firstname: random(["Max", "Moritz", "James", "Anna", "Lena"])
        lastname: random(["M√ºller", "Schmitz", "Schumacher", "Schneider", "Wagner"])
        age: random(18..60)
    address:
        personId: $person.id
        zip: random(11111..99999)
        city: random(["K√∂ln", "Bonn", "Berlin", "M√ºnchen", "Frankfurt am Main", "Oberhausen", "D√ºsseldorf"])
        street: random(["Hauptstra√üe", "Dorfstra√üe", "Bahnhofstra√üe", "Schillerstra√üe", "Friedhofstra√üe"])
        houseNumber: random(1..70)

output: list([$person, $address])   # This is how we specify we want to generate two objects (person and address)

output_options:
    count: 15,10       # We can give the count for each object separately like here or one count for all objects.
    format: "csv"      # the output format
```

Then run

```shell
java -jar ranger-1.2.1.jar "example_two_outputs.yaml"
```

It will create two CSV files similar to them in the `output` directory:

```csv
# output/person.csv
id,firstname,lastname,age
40,Lena,Schumacher,19
70,Moritz,Schumacher,43
83,Moritz,Schneider,23
49,James,Schumacher,49
5,Anna,Wagner,48
43,Max,M√ºller,39
67,Moritz,Schmitz,25
29,Lena,M√ºller,21
35,Anna,M√ºller,42
41,Anna,Schmitz,39
65,Lena,Schneider,34
60,Lena,Schmitz,36
4,Lena,Schneider,38
52,Lena,Schneider,59
58,Anna,Schmitz,3
```

```csv
# output/address.csv
personId,zip,city,street,houseNumber
40,33114,K√∂ln,Dorfstra√üe,3
70,46128,Bonn,Schillerstra√üe,26
83,54236,M√ºnchen,Schillerstra√üe,46
49,32761,Berlin,Dorfstra√üe,47
5,25889,Frankfurt am Main,Schillerstra√üe,29
43,88579,Frankfurt am Main,Hauptstra√üe,55
67,74286,D√ºsseldorf,Hauptstra√üe,34
29,37178,M√ºnchen,Friedhofstra√üe,64
35,64953,Bonn,Hauptstra√üe,58
41,91287,Oberhausen,Dorfstra√üe,2
```

# Run time

The run time increases linearly with the number of elements to generate. \
Example run time for a complex YAML configuration file on an average Desktop PC is given below.

| Count n | 10     | 100    | 100 000 | 1 Million        | 100 Million        | 1 Billion (10^9)       |
|---------|--------|--------|---------|------------------|--------------------|------------------------|
| Time    | 0.228s | 2.157s | 16.914s | 178.202s (~3min) | 1586.007s (~27min) | 16854,773s (~4h 41min) |

# Dry-run option

Run RangerCLI with the dry-run option to display the output in the terminal instead of writing it to the output file.
May be useful for testing purposes:

```shell
java -jar ranger-1.2.1.jar --dry-run "example.yaml"
```

# Usage and command line options

RangerCLI allows to specify or override the `output_options` at run time via command line options.

See an up to date overview of the available command line options by running

```shell
java -jar ranger-1.2.1.jar --help
```

It will show something like this:

````text
Usage:

ranger <yamlFile> [-o <outputDir>] [-c <count>[,<count>...]] [-f <format>] [OPTIONS]

Description:

Generate test data from YAML configuration file.

Parameters:
      <yamlFile>                             Path to YAML configuration file

Options:
  -o, --output=<outputDir>                   The output directory (default: output)
  -c, --counts=<count>[,<count>...]          The count of objects to generate (comma separated for multiple outputs)
  -f, --output-format=<format>               The output format. Must be one of [json, jsonl, elastic_json, csv]
      --csv-delimiter=<csvDelimiter>         The csv delimiter character (for csv format)
      --elastic-index=<elasticsearchIndex>   The elasticsearch index (for elastic_json format)
      --encoding=<encoding>                  The encoding for reading and writing files. Must be one of [US_ASCII, ISO_8859_1, UTF_8, UTF_16, ANSI, SYSTEM] (default: UTF_8)
      --dry-run                              Print output to console and not to file
  -m                                         Enable multi core processing (experimental, use only if order of generated objects is not important)
  -h, --help                                 Show this help message and exit.
  -V, --version                              Print version information and exit.
````
